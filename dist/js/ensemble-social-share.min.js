/*!
 * ensemble Social Share
 * @version 0.0.4
 * @link https://github.com/loltgt/ensemble-social-share
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";class locale{constructor(t){return"object"==typeof locale[t]?locale[t]:locale[0]}static defaults(){return Object.fromEntries(["ETAGN","EPROP","EMTAG","EOPTS","EELEM","EMETH","DOM"].map((t=>[t,t])))}}const e=locale.defaults(),s="html|head|body|meta|link|style|script";class part{render(){delete this.element,delete this.render}bind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}place(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns;return!!this[e].prependChild(t[e])}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(!t instanceof Element||RegExp(s,"i").test(t.tagName)||RegExp(`(<(${s})*>)`,"i").test(t.innerHTML))throw new Error(e.EMTAG);return this.empty(),!!this[this.ns].appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){return Array.prototype.map.call(this[this.ns].children,(t=>t._1))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild._1:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild._1:null}}class Compo extends part{constructor(t,s,n,i,o,r){super();const a=this.ns=`_${t}`,l=s?s.toString():"div";if(RegExp("html|head|body|meta|link|style|script","i").test(l))throw new Error(e.ETAGN);const c=this[a]=this.element(t,l,n,i,o,r);if(this.__Compo=1,this[a]._1=this,i&&"object"==typeof i)for(const s in i){const n=s.toString();if(RegExp("attributes|classList|innerHTML|outerHTML|nodeName|nodeType").test(n))throw new Error(e.EPROP);if(0===n.indexOf("on")&&i[n]&&"function"==typeof i[n])c[n]=i[n].bind(this);else if("object"!=typeof i[n])c[n]=i[n];else if("children"==n&&"object"==typeof i[n]&&i[n].length)for(const e of i.children){const{tag:s,name:n,props:i}=e;this.append(new Compo(t,s,n,i))}}if(n){const e=c.className;c.className="","string"==typeof n?c.className=`${t}-${n}`:"object"==typeof n&&(c.className=Object.values(n).map((e=>`${t}-${e}`)).join(" ")),e&&(c.className+=` ${e}`)}this.render()}element(t,e,s,n,i,o){return o?document.createElementNS(o,e,i):document.createElement(e,i)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){return getComputedStyle(this[this.ns])[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return console.warn(e.DOM),this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&t.parentElement._1?t.parentElement._1:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling._1:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling._1:null}get classList(){return this[this.ns].classList}static isCompo(t){return t instanceof Compo}}class Data{constructor(t,e){e&&"object"==typeof e&&Object.assign(this,{},e);const s=this.ns=`_${t}`;this.__Data=0,this[s]={ns:t}}compo(t,e,s,n=!1,i=!1,o=!1){const r=this[this.ns].ns;let a;return a=n?{ns:r,tag:t,name:e,props:s,load:i,unload:o}:new Compo(r,t,e,s),i&&"function"==typeof i&&(a.load=s.onload=i),o&&"function"==typeof o&&(a.unload=s.onunload=o),a}async render(t){const e=this[this.ns],s=this;e[t]&&e[t]._||(e[t]={_:s[t],load:s[t].load,unload:s[t].unload},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].load()}async unload(t){const e=this[this.ns];e[t]&&e[t]._&&e[t].unload()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t]._.ns,s[t]._.name,s[t]._.props):s[t]&&s[t]._&&s[t].load()}static isData(t){return t instanceof Data}}class Event{constructor(t,e,s){const n=this.ns=`_${t}`;s=(Compo.isCompo(s)?s[t]:s)||document,this.__Event=0,this[n]={name:e,node:s}}add(t,e=!1){const{node:s,name:n}=this[this.ns];s.addEventListener(n,t,e)}remove(t){const{node:e,name:s}=this[this.ns];e.removeEventListener(s,t)}static isEvent(t){return t instanceof Event}}class base{constructor(){const t=arguments;let s,n;if(t.length>1?(s=t[0],n=t[1]):"object"==typeof t[0]&&t[0].nodeType?s=t[0]:n=t[0],n&&"object"!=typeof n)throw new TypeError(e.EOPTS);if(s&&"object"!=typeof s)throw new TypeError(e.EELEM);this.binds(),this.options=this.opts(this.defaults(),n),Object.freeze(this.options),this.element=s}opts(t,e={}){const s={};for(const n in t)null!=t[n]&&"object"==typeof t[n]?s[n]=Object.assign(t[n],e[n]):s[n]=void 0!==e[n]?e[n]:t[n];return s}compo(t,e,s){const n=this.options.ns;return null!=t?new Compo(n,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){return"string"==typeof t?new Event(this.options.ns,t,e):t?(t.preventDefault(),void t.target.blur()):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}appendNode(t,e){return!!t.appendChild(e)}prependNode(t,e){return!!t.prependChild(e)}removeNode(t,e){return!!t.removeChild(e)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}setAttr(t,e,s){t.setAttribute(e,s)}delAttr(t,e){t.removeAttribute(e)}styleTime(t,e){let s=Compo.isCompo(t)?t.getStyle(e):getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}wrap(t){const s=this;if(this[t]&&"function"!=typeof t)throw new TypeError(e.EMETH);return function(e){t.call(s,e,this)}}delay(t,e,s){const n=e?this.styleTime(e,"transitionDuration"):0;setTimeout(t,n||s)}}const n=Object.freeze({share:0,send:1,email:2,copy:3,webapi:4});t.SocialShare=class SocialShare extends base{static actionEnum(){return n}aks(){const t=n;return{facebook:t.share,x:t.share,linkedin:t.share,threads:t.share,bluesky:t.share,reddit:t.share,mastodon:t.share,quora:t.share,whatsapp:t.send,messenger:t.send,telegram:t.send,skype:t.send,viber:t.send,line:t.send,snapchat:t.send,"send-email":t.email,"copy-link":t.copy,"web-share":t.webapi}}defaults(){return this.ska=this.aks(),{ns:"share",root:"body",className:"social-share",layout:"h",icons:"font",iconPrefix:"icon",iconSvgSrc:"",iconSymbolHashPrefix:"icon",iconSvgHashPrefix:"",effects:!0,link:"",title:"",description:"",intents:null,scaffold:this.ska,uriform:{facebook:"https://www.facebook.com/dialog/share?display=popup&href=%url%&app_id=%app_id%",x:"https://twitter.com/intent/tweet?text=%title%&url=%url%",linkedin:"https://www.linkedin.com/sharing/share-offsite?mini=true&url=%url%&title=%title%&ro=false&summary=%summary%",threads:"https://threads.net/intent/post?text=%url%",bluesky:"https://bsky.app/intent/compose?text=%url%",reddit:"https://www.reddit.com/submit?url=%url%&title=%title%",mastodon:"https://mastodon.social/share?text=%text%",quora:"https://www.quora.com/share?url=%url%&title=%title%",whatsapp:"https://api.whatsapp.com/send?text=%text%",messenger:"fb-messenger://share/?link=%url%&app_id=%app_id%",telegram:"https://telegram.me/share/url?url=%url%&text=%text%",skype:"https://web.skype.com/share?url=%url%&text=%title%",viber:"viber://forward?text=%text%",line:"https://line.me/R/msg/text/?%text%",snapchat:"https://www.snapchat.com/share?link=%url%","send-email":"mailto:?subject=%subject%&body=%text%"},selectorLink:{element:'link[rel="canonical"]',attribute:"href"},selectorTitle:null,selectorDescription:{element:'meta[name="description"]',attribute:"content"},label:{},locale:{label:"Share",share:"Share on %s",send:"Send to %s",subject:"An interesting thing",text:"Hi! Here something may interesting you: %s",email:"Send via email",copy:"Copy link",copied:"Copied link!",whatsapp:"WhatsApp",linkedin:"LinkedIn","web-share":"Share"},onInit:()=>{},onIntent:()=>{}}}binds(){this.intent=this.wrap(this.intent)}constructor(){super(...arguments),this.init()}generator(){const t=this.options,e=this.$=this.compo(!1,!1,{className:"object"==typeof t.className?Object.values(t.className).join(" "):t.className});if(e.setAttr("data-social-share",""),t.label){const s=this.compo("span","label",t.label);s.classList.add("label"),!1 in t.label&&(s.innerText=t.locale.label.toString()),e.append(s)}"v"==t.layout&&e.classList.add(`${t.ns}-vertical`);const s=this.actions=this.compo("ul","actions");e.append(s),this.built=!0}init(){if(this.built)return;const{options:t}=this;this.root=this.selector(t.root);let e=[];if(t.intents||this.ska!==t.scaffold)t.intents instanceof Array?e=t.intents:t.intents&&(e=Object.keys(t.scaffold));else{const t=Object.keys(this.ska);for(const s of[0,1,8,9,10,2,15,16,17])e.push(t[s].toString())}this.intents=e,this.generator(),this.element&&this.$.place(this.element,function(t){this.element=t}.bind(this)),this.populate(),t.onInit.call(this,this)}populate(){const t=n,{options:e}=this,{locale:s}=e;for(const n of this.intents){if(!n in e.scaffold)continue;const i=n in s?s[n].toString():n.replace(/\w/,(t=>t.toUpperCase()));let o;switch(e.scaffold[n]){case t.share:o=s.share.toString().replace("%s",i);break;case t.send:o=s.send.toString().replace("%s",i);break;case t.email:o=s.email.toString();break;case t.copy:o=s.copy.toString();break;case t.webapi:if(!navigator.share)continue;o=s["web-share"].toString()}this.action(n,o)}}action(t,e){const{options:s}=this,n=this.compo("li","action",{className:`${s.ns}-action-${t}`}),i=this.compo("button",["button","intent"],{className:`${s.ns}-intent-${t}`,title:e,onclick:this.intent});n.setAttr("data-share-intent",t),n.append(i);const o=this.compo("span","icon",{className:`${s.iconPrefix}-${t}`}),r="http://www.w3.org/2000/svg";if("symbol"==s.icons){const e=new(this.compo())(s.ns,"svg",!1,!1,!1,r),n=new(this.compo())(s.ns,"use",!1,!1,!1,r),{iconSymbolHashPrefix:i}=s,a=i?`${i}-${t}`:t;n.setAttr("href",`#${a}`),e.append(n),o.append(e)}else if("svg"==s.icons&&s.iconSvgSrc){const{iconSvgSrc:e,iconSvgHashPrefix:n}=s,i=n?`${n}-${t}`:t,r=this.compo("img",!1,{src:`${e}#${i}`});o.append(r)}i.append(o),this.actions.append(n)}intent(t,e){if(this.event(t),!t.isTrusted)return;const s=n,{options:i}=this,{locale:o}=i;if(!this.compo().isCompo(e))return;const r=e.parent;if(!r||!r.hasAttr("data-share-intent"))return;const a=r.getAttr("data-share-intent");if(-1==this.intents.indexOf(a))return;let l,c,h,p;l=i.link?i.link:i.selectorLink&&"object"==typeof i.selectorLink&&this.selector(i.selectorLink.element)?this.getAttr(this.selector(i.selectorLink.element),i.selectorLink.attribute):window.location.href,c=i.title?i.title:i.selectorTitle&&"object"==typeof i.selectorTitle&&this.selector(i.selectorTitle.element)?this.getAttr(this.selector(i.selectorTitle.element),i.selectorTitle.attribute):document.title,h=i.description?i.description:i.selectorDescription&&"object"==typeof i.selectorDescription&&this.selector(i.selectorDescription.element)?this.getAttr(this.selector(i.selectorDescription.element),i.selectorDescription.attribute):c,p="\r\n\r\n%title%\r\n%url%\r\n\r\n";const d={url:l,title:c,text:"\r\n\r\n%title%\r\n%url%\r\n\r\n",summary:h};if(i.onIntent.call(this,this,t,a,d),d.text=o.text.toString().replace("%s",d.text),a in i.scaffold)switch(i.scaffold[a]){case s.email:this.sendEmail(t,d);break;case s.copy:this.copyLink(t,d);break;case s.webapi:this.webShare(t,d);break;default:this.share(t,d,a,r)}}text(t){return encodeURIComponent(t.text.replace("%url%",t.url).replace("%title%",t.title).replace("%summary%",t.summary))}share(t,e,s,n){const{options:i}=this;if(!s in i.uriform)return;let o=i.uriform[s].replace("%url%",encodeURIComponent(e.url)).replace("%title%",encodeURIComponent(e.title)).replace("%summary%",encodeURIComponent(e.summary));const r=n.getAttr("title");if(/%text%/.test(i.uriform[s])&&(o=o.replace("%text%",this.text(e))),"facebook"==s||"messenger"==s){const t=`${s}_app_id`in i?i[`${s}_app_id`]:"";o=o.replace("%app_id%",encodeURIComponent(t))}window.open(o,r,"toolbar=0,status=0,width=640,height=480")}sendEmail(t,e){const{options:s}=this,{locale:n}=s,i=s.uriform["send-email"].replace("%subject%",encodeURIComponent(n.subject.toString())).replace("%text%",this.text(e));window.open(i,"_self")}copyLink(t,e){if(!this.element)return;const{options:s}=this,{locale:n}=s;try{navigator.clipboard.writeText(e.url.toString())}catch(t){if(t instanceof TypeError){const t=document.createElement("textarea");t.style="position:absolute;width:0;height:0;opacity:0;z-index:-1;overflow:hidden",t.value=e.url.toString(),this.appendNode(this.element,t),t.focus(),t.select(),document.execCommand("copy"),t.remove()}else console.error("webShare",t.message)}if(s.effects){const t=this.root,e=this.compo(!1,"effects-copied-link--bg",{hidden:!0}),s=this.compo("span","copied-link-msg",{innerText:n.copied.toString()});t.classList.add("share-effects-copied-link"),e.bind(t),s.bind(t),e.show(),this.delay((function(){s.unbind(t),e.unbind(t),t.classList.remove("share-effects-copied-link")}),e,800)}}async webShare(t,e){try{await navigator.share({title:e.title,url:e.url})}catch(t){t instanceof TypeError||console.error("webShare",t.message)}}}}(this.ensemble=this.ensemble||{});