/*!
 * ensemble Social Share
 * @version 0.0.4
 * @link https://github.com/loltgt/ensemble-social-share
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";const e="undefined"==typeof Symbol?0:Symbol,s=/html|head|body|meta|link|style|script/i,n=/(<(html|head|body|meta|link|style|script)*>)/i;class _composition{_render(){delete this._element,delete this._render}bound(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbound(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}overlap(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns;return!!this[e].prependChild(t[e])}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(t instanceof Element==0||s.test(t.tagName)||n.test(t.innerHTML))throw new Error("Object cannot be resolved into a valid node.");const e=this[this.ns];return this.empty(),!!e.appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){const t=this[this.ns];return Array.prototype.map.call(t.children,(t=>t.__compo))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild.__compo:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild.__compo:null}}const i=/html|head|body|meta|link|style|script/i,o=/attributes|classList|innerHTML|outerHTML|nodeName|nodeType/;class Compo extends _composition{constructor(t,e,s,n,r,a){if(!new.target)throw"Bad invocation. Must be called with `new`.";super();const l=this.ns="_"+t,c=e?e.toString():"div";if(i.test(c))throw new Error("Provided tag name is not a valid name.");const h=this[l]=this._element(t,c,s,n,r,a);if(this.__Compo=!0,this[l].__compo=this,n&&"object"==typeof n)for(const e in n){const s=e.toString();if(o.test(s))throw new Error("Provided property name is not a valid name.");if(0===s.indexOf("on")&&n[s]&&"function"==typeof n[s])h[s]=n[s].bind(this);else if("object"!=typeof n[s])h[s]=n[s];else if("children"==s&&"object"==typeof n[s]&&n[s].length)for(const e of n.children){const s=e.tag,n=e.name,i=e.props;this.append(new Compo(t,s,n,i))}}if(s){const e=h.className;h.className="","string"==typeof s?h.className=t+"-"+s:"object"==typeof s&&(h.className=s.map((e=>t+"-"+e)).join(" ")),e&&(h.className+=" "+e)}this._render()}_element(t,e,s,n,i,o){return o?document.createElementNS(e,[...o,...i]):document.createElement(e,i)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){const e=this[this.ns];return window.getComputedStyle(e)[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&"__compo"in t.parentElement?t.parentElement.__compo:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling.__compo:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling.__compo:null}get classList(){return this[this.ns].classList}static isCompo(t){return e?e.for(t)===e.for(Compo.prototype):t&&"object"==typeof t&&"__Compo"in t}get[e.toStringTag](){return"ensemble.Compo"}}class Data{constructor(t,e){if(!new.target)throw"Bad invocation. Must be called with `new`.";e&&"object"==typeof e&&Object.assign(this,{},e);const s=this.ns="_"+t;this.__Data=!0,this[s]={ns:t}}compo(t,e,s,n=!1,i=!1,o=!1){const r=this[this.ns].ns;let a;return a=n?{ns:r,tag:t,name:e,props:s,fresh:i,stale:o}:new Compo(r,t,e,s),i&&"function"==typeof i&&(a.fresh=s.onfresh=i),o&&"function"==typeof o&&(a.stale=s.onstale=o),a}async render(t){const e=this[this.ns],s=this;e[t]&&e[t].rendered||(e[t]={rendered:!0,fresh:s[t].fresh,stale:s[t].stale,params:s[t]},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].fresh()}async stale(t){const e=this[this.ns];e[t]&&e[t].rendered&&e[t].stale()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t].params.ns,s[t].params.name,s[t].params.props):s[t]&&s[t].rendered&&s[t].fresh()}static isData(t){return e?e.for(t)===e.for(Data.prototype):t&&"object"==typeof t&&"__Data"in t}get[e.toStringTag](){return"ensemble.Data"}}class Event{constructor(t,e,s){if(!new.target)throw"Bad invocation. Must be called with `new`.";const n=this.ns="_"+t;s=(Compo.isCompo(s)?s.node:s)||document,this.__Event=!0,this[n]={name:e,node:s}}add(t,e=!1){const s=this[this.ns],n=s.node,i=s.name;n.addEventListener(i,t,e)}remove(t){const e=this[this.ns],s=e.node,n=e.name;s.removeEventListener(n,t)}static isEvent(t){return e?e.for(t)===e.for(Event.prototype):t&&"object"==typeof t&&"__Event"in t}get[e.toStringTag](){return"ensemble.Event"}}class base{constructor(){let t,e;if(arguments.length>1?(t=arguments[0],e=arguments[1]):e=arguments[0],e&&"object"!=typeof e)throw new TypeError('Passed argument "options" is not an Object.');if(t&&"object"!=typeof t)throw new TypeError('Passed argument "element" is not an Object.');this._bindings(),this.options=this.defaults(this._defaults(),e),Object.freeze(this.options),this.element=t}defaults(t,e){const s={};for(const n in t)null!=t[n]&&"object"==typeof t[n]?s[n]=Object.assign(t[n],e[n]):s[n]=void 0!==e[n]?e[n]:t[n];return s}compo(t,e,s){const n=this.options.ns;return null!=t?new Compo(n,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){return"string"==typeof t?new Event(this.options.ns,t,e):t?(t.preventDefault(),void t.target.blur()):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}appendNode(t,e){return!!t.appendChild(e)}prependNode(t,e){return!!t.prependChild(e)}removeNode(t,e){return!!t.removeChild(e)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}setAttr(t,e,s){t.setAttribute(e,s)}delAttr(t,e){t.removeAttribute(e)}getTime(t,e="transitionDuration"){let s=Compo.isCompo(t)?t.getStyle(e):window.getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}binds(t){const e=this;return function(s){t.call(e,s,this)}}delay(t,e,s){const n=e?this.getTime(e):0;setTimeout(t,n||s)}}const r=Object.freeze({share:0,send:1,email:2,copy:3,webapi:4});t.SocialShare=class SocialShare extends base{static actionEnum(){return r}_aks(){const t=r;return{facebook:t.share,x:t.share,linkedin:t.share,threads:t.share,bluesky:t.share,reddit:t.share,stumbleupon:t.share,mastodon:t.share,quora:t.share,whatsapp:t.send,messenger:t.send,telegram:t.send,skype:t.send,viber:t.send,line:t.send,snapchat:t.send,"send-email":t.email,"copy-link":t.copy,"web-share":t.webapi}}_defaults(){return this.ska=this._aks(),{ns:"share",root:"body",className:"social-share",effects:!0,link:"",title:"",description:"",intents:null,scaffold:this.ska,uriform:{facebook:"https://www.facebook.com/dialog/share?display=popup&href=%url%&app_id=%app_id%",x:"https://twitter.com/intent/tweet?text=%title%&url=%url%",linkedin:"https://www.linkedin.com/sharing/share-offsite?mini=true&url=%url%&title=%title%&ro=false&summary=%summary%",threads:"https://threads.net/intent/post?text=%url%",bluesky:"https://bsky.app/intent/compose?text=%url%",reddit:"https://www.reddit.com/submit?url=%url%&title=%title%",stumbleupon:"https://www.stumbleupon.com/submit?url=%url%&title=%title%",mastodon:"https://mastodon.social/share?text=%text%",quora:"https://www.quora.com/share?url=%url%&title=%title%",whatsapp:"https://api.whatsapp.com/send?text=%text%",messenger:"fb-messenger://share/?link=%url%&app_id=%app_id%",telegram:"https://telegram.me/share/url?url=%url%&text=%text%",skype:"https://web.skype.com/share?url=%url%&text=%title%",viber:"viber://forward?text=%text%",line:"https://line.me/R/msg/text/?%text%",snapchat:"https://www.snapchat.com/share?link=%url%","send-email":"mailto:?subject=%subject%&body=%text%"},selectorLink:{element:'link[rel="canonical"]',attribute:"href"},selectorTitle:null,selectorDescription:{element:'meta[name="description"]',attribute:"content"},label:{},locale:{label:"Share",share:"Share on %s",send:"Send to %s",subject:"An interesting thing",text:"Hi! Here something may interesting you: %s",email:"Send via email",copy:"Copy link",copied:"Copied link!",whatsapp:"WhatsApp",linkedin:"LinkedIn","web-share":"Share"},onInit:function(){},onIntent:function(){}}}_bindings(){this.intent=this.binds(this.intent)}constructor(){if(!new.target)throw"Bad invocation. Must be called with `new`.";super(...arguments),this.init()}generator(){const t=this.options,e=this.stage=this.compo(!1,!1,{className:"object"==typeof t.className?t.className.join(" "):t.className});if(e.setAttr("data-social-share",""),t.label){const s=this.compo("span","label",t.label);s.classList.add("label"),"innerText"in t.label==0&&(s.innerText=t.locale.label.toString()),e.append(s)}const s=this.actions=this.compo("ul","actions");e.append(s),this.built=!0}init(){if(this.built)return;const t=this.options;this.root=this.selector(t.root);let e=[];if(t.intents||this.ska!==t.scaffold)Array.prototype.isPrototypeOf(t.intents)?e=t.intents:t.intents&&(e=Object.keys(t.scaffold));else{const t=Object.keys(this.ska);for(const s of[0,1,9,10,11,2,16,17,18])e.push(t[s].toString())}this.intents=e,this.generator(),this.element&&this.stage.overlap(this.element,function(t){this.element=t}.bind(this)),this.populate(),t.onInit.call(this,this)}populate(){const t=this.options,e=t.locale,s=r;for(const n of this.intents){if(!n in t.scaffold)continue;const i=n in e?e[n].toString():n.replace(/\w/,(t=>t.toUpperCase()));let o;switch(t.scaffold[n]){case s.share:o=e.share.toString().replace("%s",i);break;case s.send:o=e.send.toString().replace("%s",i);break;case s.email:o=e.email.toString();break;case s.copy:o=e.copy.toString();break;case s.webapi:if(!("share"in window.navigator)||"function"!=typeof window.navigator.share)continue;o=e["web-share"].toString()}this.action(n,o)}}action(t,e){const s=this.options,n=this.compo("li","action",{className:s.ns+"-action-"+t}),i=this.compo("button",["button","intent"],{className:s.ns+"-intent-"+t,title:e,onclick:this.intent});n.setAttr("data-share-intent",t),n.append(i);const o=this.compo("span","icon",{className:"icon-"+t});i.append(o),this.actions.append(n)}intent(t,e){if(this.event(t),!t.isTrusted)return;const s=this.options,n=s.locale,i=r;if(!this.compo().isCompo(e))return;const o=e.parent;if(!o||!o.hasAttr("data-share-intent"))return;const a=o.getAttr("data-share-intent");if(-1==this.intents.indexOf(a))return;let l,c,h,p;l=s.link?s.link:s.selectorLink&&"object"==typeof s.selectorLink&&this.selector(s.selectorLink.element)?this.getAttr(this.selector(s.selectorLink.element),s.selectorLink.attribute):window.location.href,c=s.title?s.title:s.selectorTitle&&"object"==typeof s.selectorTitle&&this.selector(s.selectorTitle.element)?this.getAttr(this.selector(s.selectorTitle.element),s.selectorTitle.attribute):document.title,h=s.description?s.description:s.selectorDescription&&"object"==typeof s.selectorDescription&&this.selector(s.selectorDescription.element)?this.getAttr(this.selector(s.selectorDescription.element),s.selectorDescription.attribute):c,p="\r\n\r\n%title%\r\n%url%\r\n\r\n";const d={url:l,title:c,text:"\r\n\r\n%title%\r\n%url%\r\n\r\n",summary:h};if(s.onIntent.call(this,this,t,a,d),d.text=n.text.toString().replace("%s",d.text),a in s.scaffold)switch(s.scaffold[a]){case i.email:this.sendEmail(t,d);break;case i.copy:this.copyLink(t,d);break;case i.webapi:this.webShare(t,d);break;default:this.share(t,d,a,o)}}text(t){return encodeURIComponent(t.text.replace("%url%",t.url).replace("%title%",t.title).replace("%summary%",t.summary))}share(t,e,s,n){const i=this.options;if(!s in i.uriform)return;let o=i.uriform[s].replace("%url%",encodeURIComponent(e.url)).replace("%title%",encodeURIComponent(e.title)).replace("%summary%",encodeURIComponent(e.summary));const r=n.getAttr("title");if(/%text%/.test(i.uriform[s])&&(o=o.replace("%text%",this.text(e))),"facebook"==s||"messenger"==s){const t=s+"_app_id"in i?i[s+"_app_id"]:"";o=o.replace("%app_id%",encodeURIComponent(t))}window.open(o,r,"toolbar=0,status=0,width=640,height=480")}sendEmail(t,e){const s=this.options,n=s.locale,i=s.uriform["send-email"].replace("%subject%",encodeURIComponent(n.subject.toString())).replace("%text%",this.text(e));window.open(i,"_self")}copyLink(t,e){if(!this.element)return;const s=this.options,n=s.locale;{const t=document.createElement("textarea");t.style="position:absolute;width:0;height:0;opacity:0;z-index:-1;overflow:hidden",t.value=e.url.toString(),this.appendNode(this.element,t),t.focus(),t.select(),document.execCommand("copy"),t.remove()}if(s.effects){const t=this.root,e=this.compo(!1,"effects-copied-link--bg",{hidden:!0}),s=this.compo("span","copied-link-msg",{innerText:n.copied.toString()});t.classList.add("share-effects-copied-link"),e.bound(t),s.bound(t),e.show(),this.delay((function(){s.unbound(t),e.unbound(t),t.classList.remove("share-effects-copied-link")}),e,800)}}async webShare(t,e){try{await window.navigator.share({title:e.title,url:e.url})}catch(t){TypeError}}}}(this.ensemble=this.ensemble||{});