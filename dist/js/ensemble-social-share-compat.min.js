/*! * loltgt/ensemble.SocialShare (compat) * * @version 0.0.2 * @link https://github.com/loltgt/ensemble-social-share * @copyright Copyright (C) Leonardo Laureti * @license MIT License */!function(t,r){if("function"==typeof define&&define.amd)define(["exports"],r);else if("undefined"!=typeof exports)r(exports);else{var o={exports:{}};r(o.exports),t.ensemble=o.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(t){"use strict";function asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),h=u.value}catch(t){return void o(t)}u.done?r(h):Promise.resolve(h).then(i,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.SocialShare=void 0;var r=function(t){var r,o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function(t,r,o){return t[r]=o}}function wrap(t,r,o,i){var a=r&&r.prototype instanceof Generator?r:Generator,l=Object.create(a.prototype),c=new Context(i||[]);return l._invoke=function makeInvokeMethod(t,r,o){var i=h;return function invoke(a,l){if(i===d)throw new Error("Generator is already running");if(i===y){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===m)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===h)throw i=y,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=d;var v=tryCatch(t,r,o);if("normal"===v.type){if(i=o.done?y:p,v.arg===m)continue;return{value:v.arg,done:o.done}}"throw"===v.type&&(i=y,o.method="throw",o.arg=v.arg)}}}(t,o,c),l}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var v={};define(v,l,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(values([])));b&&b!==o&&i.call(b,l)&&(v=b);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(v);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(o,a,l,c){var u=tryCatch(t[o],t,a);if("throw"!==u.type){var h=u.arg,p=h.value;return p&&"object"==typeof p&&i.call(p,"__await")?r.resolve(p.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(p).then((function(t){h.value=t,l(h)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var o;this._invoke=function enqueue(t,i){function callInvokeWithMethodAndArg(){return new r((function(r,o){invoke(t,i,r,o)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(t,o){var i=t.iterator[o.method];if(i===r){if(o.delegate=null,"throw"===o.method){if(t.iterator.return&&(o.method="return",o.arg=r,maybeInvokeDelegate(t,o),"throw"===o.method))return m;o.method="throw",o.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=tryCatch(i,t.iterator,o.arg);if("throw"===a.type)return o.method="throw",o.arg=a.arg,o.delegate=null,m;var l=a.arg;return l?l.done?(o[t.resultName]=l.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=r),o.delegate=null,m):l:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,m)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var o=t[l];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,c=function next(){for(;++a<t.length;)if(i.call(t,a))return next.value=t[a],next.done=!1,next;return next.value=r,next.done=!0,next};return c.next=c}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(g,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,l,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=[];for(var o in t)r.push(o);return r.reverse(),function next(){for(;r.length;){var o=r.pop();if(o in t)return next.value=o,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!t)for(var o in this)"t"===o.charAt(0)&&i.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function handle(i,a){return c.type="throw",c.arg=t,o.next=i,a&&(o.method="next",o.arg=r),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var l=this.tryEntries[a],c=l.completion;if("root"===l.tryLoc)return handle("end");if(l.tryLoc<=this.prev){var u=i.call(l,"catchLoc"),h=i.call(l,"finallyLoc");if(u&&h){if(this.prev<l.catchLoc)return handle(l.catchLoc,!0);if(this.prev<l.finallyLoc)return handle(l.finallyLoc)}else if(u){if(this.prev<l.catchLoc)return handle(l.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return handle(l.finallyLoc)}}}},abrupt:function(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,m):this.complete(c)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,i){return this.delegate={iterator:values(t),resultName:o,nextLoc:i},"next"===this.method&&(this.arg=r),m}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}function _asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function _extends(){return _extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},_extends.apply(this,arguments)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw l}}}}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,r,o){return r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}var o="undefined"==typeof Symbol?0:Symbol,i=/html|head|body|meta|link|style|script/i,a=/(<(html|head|body|meta|link|style|script)*>)/i,l=/html|head|body|meta|link|style|script/i,c=/attributes|classList|innerHTML|outerHTML|nodeName|nodeType/,u=function(t,r){_inherits(Compo,t);var i=_createSuper(Compo);function Compo(t,r,o,a,u,h){var p;if(_classCallCheck(this,Compo),!(this instanceof Compo?this.constructor:void 0))throw"ensemble.Compo error: Bad invocation, must be called with new.";var d=(p=i.call(this))._ns="_"+t,y=r?r.toString():"div";if(l.test(r))throw new Error("ensemble.Compo error: The tag name provided ('".concat(y,"') is not a valid name."));var m=p[d]=p._element(t,y,o,a,u,h);if(p.__Compo=!0,p[d].__compo=_assertThisInitialized(p),a&&"object"==_typeof(a))for(var v in a){var _=v.toString();if(c.test(_))throw new Error("ensemble.Compo error: The property name provided ('".concat(_,"') is not a valid name."));if(0===_.indexOf("on")&&a[_]&&"function"==typeof a[_])m[_]=a[_].bind(_assertThisInitialized(p));else if("object"!=_typeof(a[_]))m[_]=a[_];else if("children"==_&&"object"==_typeof(a[_])&&a[_].length){var b,g=_createForOfIteratorHelper(a.children);try{for(g.s();!(b=g.n()).done;){var w=b.value,k=w.tag,x=w.name,C=w.props;p.append(new Compo(t,k,x,C))}}catch(t){g.e(t)}finally{g.f()}}}if(o){var S=m.className;m.className="","string"==typeof o?m.className=t+"-"+o:"object"==_typeof(o)&&(m.className=o.map((function(r){return t+"-"+r})).join(" ")),S&&(m.className+=" "+S)}return p._renderer(),p}return _createClass(Compo,[{key:"_element",value:function _element(t,r,o,i,a,l){return l?document.createElementNS(r,[].concat(_toConsumableArray(l),_toConsumableArray(a))):document.createElement(r,a)}},{key:"hasAttr",value:function hasAttr(t){return this[this._ns].hasAttribute(t)}},{key:"getAttr",value:function getAttr(t){return this[this._ns].getAttribute(t)}},{key:"setAttr",value:function setAttr(t,r){this[this._ns].setAttribute(t,r)}},{key:"delAttr",value:function delAttr(t){this[this._ns].removeAttribute(t)}},{key:"getStyle",value:function getStyle(t){return window.getComputedStyle(this[this._ns])[t]}},{key:"show",value:function show(){this[this._ns].hidden=!1}},{key:"hide",value:function hide(){this[this._ns].hidden=!0}},{key:"enable",value:function enable(){this[this._ns].disabled=!1}},{key:"disable",value:function disable(){this[this._ns].disabled=!0}},{key:"node",get:function get(){return console.warn("ensemble.Compo","Direct access to the node is strongly discouraged."),this[this._ns]}},{key:"parent",get:function get(){var t=this._ns;return this[t].parentElement&&"__compo"in this[t].parentElement?this[t].parentElement.__compo:null}},{key:"previous",get:function get(){var t=this._ns;return this[t].previousElementSibling?this[t].previousElementSibling.__compo:null}},{key:"next",get:function get(){var t=this._ns;return this[t].nextElementSibling?this[t].nextElementSibling.__compo:null}},{key:"classList",get:function get(){return this[this._ns].classList}},{key:r,get:function get(){return"ensemble.Compo"}}],[{key:"isCompo",value:function isCompo(t){return o?o.for(t)===o.for(Compo.prototype):t&&"object"==_typeof(t)&&"__Compo"in t}}]),Compo}(function(){function _composition(){_classCallCheck(this,_composition)}return _createClass(_composition,[{key:"_renderer",value:function _renderer(){delete this._element,delete this._renderer}},{key:"install",value:function install(t,r){return"function"==typeof r&&r.call(this,this[this._ns]),!!t.appendChild(this[this._ns])}},{key:"uninstall",value:function uninstall(t,r){return"function"==typeof r&&r.call(this,this[this._ns]),!!t.removeChild(this[this._ns])}},{key:"up",value:function up(t,r){return"function"==typeof r&&r.call(this,this[this._ns]),!!t.replaceWith(this[this._ns])}},{key:"append",value:function append(t){var r=this._ns;return!!this[r].appendChild(t[r])}},{key:"prepend",value:function prepend(t){var r=this._ns;return!!this[r].prependChild(t[r])}},{key:"remove",value:function remove(t){var r=this._ns;return!!this[r].removeChild(t[r])}},{key:"inject",value:function inject(t){if(t instanceof Element==0||i.test(t.tagName)||a.test(t.innerHTML))throw new Error("ensemble.Compo error: The remote object could not be resolved into a valid node.");return this.empty(),!!this[this._ns].appendChild(t)}},{key:"empty",value:function empty(){for(;this.first;)this.remove(this.first)}},{key:"children",get:function get(){return Array.prototype.map.call(this[this._ns].children,(function(t){return t.__compo}))}},{key:"first",get:function get(){var t=this._ns;return this[t].firstElementChild?this[t].firstElementChild.__compo:null}},{key:"last",get:function get(){var t=this._ns;return this[t].lastElementChild?this[t].lastElementChild.__compo:null}}]),_composition}(),o.toStringTag),h=function(t){function Data(t,r){if(_classCallCheck(this,Data),!(this instanceof Data?this.constructor:void 0))throw"ensemble.Data error: Bad invocation, must be called with new.";r&&"object"==_typeof(r)&&_extends(this,{},r);var o=this._ns="_"+t;this.__Data=!0,this[o]={ns:t}}var r,i,a;return _createClass(Data,[{key:"compo",value:function compo(t,r,o){var compo,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=this[this._ns].ns;return compo=i?{ns:c,tag:t,name:r,props:o,fresh:a,stale:l}:new u(c,t,r,o),a&&"function"==typeof a&&(compo.fresh=o.onfresh=a),l&&"function"==typeof l&&(compo.stale=o.onstale=l),compo}},{key:"render",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function _callee(t){var r;return regeneratorRuntime.wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:this[r=this._ns][t]&&this[r][t].rendered||(this[r][t]={rendered:!0,fresh:this[t].fresh,stale:this[t].stale,params:this[t]},this[t]=new u(this[t].ns,this[t].tag,this[t].name,this[t].props)),this[r][t].fresh();case 2:case"end":return o.stop()}}),_callee,this)}))),function render(t){return a.apply(this,arguments)})},{key:"stale",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(t){var r;return regeneratorRuntime.wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:this[r=this._ns][t]&&this[r][t].rendered&&this[r][t].stale();case 2:case"end":return o.stop()}}),_callee2,this)}))),function stale(t){return i.apply(this,arguments)})},{key:"reflow",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(t,r){var o;return regeneratorRuntime.wrap((function _callee3$(i){for(;;)switch(i.prev=i.next){case 0:o=this._ns,r?this[o][t]=this.compo(this[o][t].params.ns,this[o][t].params.name,this[o][t].params.props):this[o][t]&&this[o][t].rendered&&this[o][t].fresh();case 2:case"end":return i.stop()}}),_callee3,this)}))),function reflow(t,o){return r.apply(this,arguments)})},{key:t,get:function get(){return"ensemble.Data"}}],[{key:"isData",value:function isData(t){return o?o.for(t)===o.for(Data.prototype):t&&"object"==_typeof(t)&&"__Data"in t}}]),Data}(o.toStringTag),p=function(t){function Event(t,r,o){if(_classCallCheck(this,Event),!(this instanceof Event?this.constructor:void 0))throw"ensemble.Event error: Bad invocation, must be called with new.";var i=this._ns="_"+t;o=(u.isCompo(o)?o.node:o)||document,this.__Event=!0,this[i]={name:r,node:o}}return _createClass(Event,[{key:"add",value:function add(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this[this._ns].node.addEventListener(this[this._ns].name,t,r)}},{key:"remove",value:function remove(t){this[this._ns].node.removeEventListener(this[this._ns].name,t)}},{key:t,get:function get(){return"ensemble.Event"}}],[{key:"isEvent",value:function isEvent(t){return o?o.for(t)===o.for(Event.prototype):t&&"object"==_typeof(t)&&"__Event"in t}}]),Event}(o.toStringTag),d=function(){function base(){_classCallCheck(this,base);var t,r,o="ensemble"+((this instanceof base?this.constructor:void 0)&&(this instanceof base?this.constructor:void 0).name?"."+(this instanceof base?this.constructor:void 0).name:"");if(arguments.length>1?(t=arguments[0],r=arguments[1]):r=arguments[0],r&&"object"!=_typeof(r))throw new TypeError("".concat(o," error: The passed argument 'options' is not of type Object."));if(t&&"object"!=_typeof(t))throw new TypeError("".concat(o," error: The passed argument 'element' is not of type Object."));this._bindings(),this.options=this.defaults(this._defaults(),r),Object.freeze(this.options),this.element=t}return _createClass(base,[{key:"defaults",value:function defaults(t,r){var o={};for(var i in t)null!=t[i]&&"object"==_typeof(t[i])?o[i]=_extends(t[i],r[i]):o[i]=void 0!==r[i]?r[i]:t[i];return o}},{key:"compo",value:function compo(t,r,o){return null!=t?new u(this.options.ns,t,r,o):u}},{key:"data",value:function data(t){return null!=t?new h(this.options.ns,t):h}},{key:"event",value:function event(t,r){return"string"==typeof t?new p(this.options.ns,t,r):t?(t.preventDefault(),void t.target.blur()):p}},{key:"selector",value:function selector(t,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r=r||document,o?r.querySelectorAll(t):r.querySelector(t)}},{key:"appendNode",value:function appendNode(t,r){return!!t.appendChild(r)}},{key:"prependNode",value:function prependNode(t,r){return!!t.prependChild(r)}},{key:"removeNode",value:function removeNode(t,r){return!!t.removeChild(r)}},{key:"cloneNode",value:function cloneNode(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.cloneNode(r)}},{key:"hasAttr",value:function hasAttr(t,r){return t.hasAttribute(r)}},{key:"getAttr",value:function getAttr(t,r){return t.getAttribute(r)}},{key:"setAttr",value:function setAttr(t,r,o){t.setAttribute(r,o)}},{key:"delAttr",value:function delAttr(t,r){t.removeAttribute(r)}},{key:"binds",value:function binds(t){var r=this;return function(o){t.call(r,o,this)}}},{key:"delay",value:function delay(t,r,o){var delay=r?this.timing(r):0;setTimeout(t,delay||o)}},{key:"timing",value:function timing(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transitionDuration",o=u.isCompo(t)?t.getStyle(r):window.getComputedStyle(t)[r];return o&&(o=o.indexOf("s")?1e3*parseFloat(o):parseInt(o)),o||0}}]),base}(),y=function(t){_inherits(SocialShare,t);var r,o=_createSuper(SocialShare);function SocialShare(){var t;if(_classCallCheck(this,SocialShare),!(this instanceof SocialShare?this.constructor:void 0))throw"ensemble.SocialShare error: Bad invocation, must be called with new.";return(t=o.apply(this,arguments)).init(),t}return _createClass(SocialShare,[{key:"_defaults",value:function _defaults(){return{ns:"share",fx:!0,root:"body",className:"social-share",link:"",title:"",description:"",displays:null,intents:{facebook:0,twitter:0,whatsapp:1,messenger:1,telegram:1,linkedin:0,"send-email":2,"copy-link":3,"web-share":4},uriform:{facebook:"https://facebook.com/sharer.php?u=%url%",twitter:"https://twitter.com/share?url=%url%&text=%title%",whatsapp:"https://api.whatsapp.com/send?text=%text%",messenger:"fb-messenger://share/?link=%url%&app_id=%app_id%",telegram:"https://telegram.me/share/url?url=%url%&text=%text%",linkedin:"https://www.linkedin.com/sharing/share-offsite?mini=true&url=%url%&title=%title%&ro=false&summary=%summary%","send-email":"mailto:?subject=%subject%&body=%text%"},selectorLink:{element:'link[rel="canonical"]',attribute:"href"},selectorTitle:null,selectorDescription:{element:'meta[name="description"]',attribute:"content"},label:{},locale:{label:"Share",share:"Share on %s",send:"Send to %s",subject:"An interesting thing",text:"Hi! There is something may interesting you: %s",email:"Send via email",copy:"Copy link",copied:"Copied link!",whatsapp:"WhatsApp",linkedin:"LinkedIn","web-share":"Share"},onInit:function onInit(){},onIntent:function onIntent(){}}}},{key:"_bindings",value:function _bindings(){this.intent=this.binds(this.intent)}},{key:"generator",value:function generator(){var t=this.options,r=this.share=this.compo(!1,!1,{className:"object"==_typeof(t.className)?t.className.join(" "):t.className});if(r.setAttr("data-social-share",""),t.label){var o=this.compo("span","label",t.label);o.classList.add("label"),"innerText"in t.label==0&&(o.innerText=t.locale.label),r.append(o)}var i=this.actions=this.compo("ul","actions");r.append(i),this.built=!0}},{key:"init",value:function init(){var t=this.options;this.built||(this.root=this.selector(t.root),this.displays=t.displays&&"object"==_typeof(t.displays)?t.displays:Object.keys(t.intents),this.generator(),this.element&&this.share.up(this.element,function(t){this.element=t}.bind(this)),this.populate(),t.onInit.call(this,this))}},{key:"populate",value:function populate(){var t=this.options;for(var r in t.intents)if(-1!=this.displays.indexOf(r)){var o=r in t.locale?t.locale[r]:r.replace(/\w/,(function(t){return t.toUpperCase()})),i=void 0;switch(t.intents[r]){case 0:i=t.locale.share.replace("%s",o);break;case 1:i=t.locale.send.replace("%s",o);break;case 2:i=t.locale.email;break;case 3:i=t.locale.copy;break;case 4:if(!("share"in window.navigator)||"function"!=typeof window.navigator.share)continue;i=t.locale["web-share"]}this.action(r,i)}}},{key:"action",value:function action(t,r){var o=this.options,action=this.compo("li","action",{className:o.ns+"-action-"+t}),i=this.compo("button",["button","intent"],{className:o.ns+"-intent-"+t,title:r,ariaLabel:r,onclick:this.intent});action.setAttr("data-share-intent",t),action.append(i);var a=this.compo("span","icon",{className:"icon-"+t});i.append(a),this.actions.append(action)}},{key:"intent",value:function intent(t,r){if(this.event(t),t.isTrusted){var o=this.options;if(this.compo().isCompo(r)){var i=r.parent;if(i&&i.hasAttr("data-share-intent")){var intent=i.getAttr("data-share-intent");if(-1!=this.displays.indexOf(intent)){var a;"\r\n\r\n%title%\r\n%url%\r\n\r\n";var l={url:o.link?o.link:o.selectorLink&&"object"==_typeof(o.selectorLink)&&this.selector(o.selectorLink.element)?this.getAttr(this.selector(o.selectorLink.element),o.selectorLink.attribute):window.location.href,title:a=o.title?o.title:o.selectorTitle&&"object"==_typeof(o.selectorTitle)&&this.selector(o.selectorTitle.element)?this.getAttr(this.selector(o.selectorTitle.element),o.selectorTitle.attribute):document.title,text:"\r\n\r\n%title%\r\n%url%\r\n\r\n",summary:o.description?o.description:o.selectorDescription&&"object"==_typeof(o.selectorDescription)&&this.selector(o.selectorDescription.element)?this.getAttr(this.selector(o.selectorDescription.element),o.selectorDescription.attribute):a};if(o.onIntent.call(this,this,t,intent,l),l.text=o.locale.text.replace("%s",l.text),intent in o.intents)switch(intent){case"send-email":this.sendEmail(t,l);break;case"copy-link":this.copyLink(t,l);break;case"web-share":this.webShare(t,l);break;default:this.social(t,l,intent,i)}}}}}}},{key:"text",value:function text(t){return encodeURIComponent(t.text.replace("%url%",t.url).replace("%title%",t.title).replace("%summary%",t.summary))}},{key:"social",value:function social(t,r,o,i){var a=this.options;if(o in a.uriform!=0){var l=a.uriform[o].replace("%url%",encodeURIComponent(r.url)).replace("%title%",encodeURIComponent(r.title)).replace("%summary%",encodeURIComponent(r.summary)),c=i.getAttr("ariaLabel"),u="toolbar=0,status=0,width=640,height=480";if(/%text%/.test(a.uriform[o])&&(l=l.replace("%text%",this.text(r))),"messenger"==o){var h="messenger_app_id"in a?a.messenger_app_id:"";l=l.replace("%app_id%",encodeURIComponent(h))}console.log(l,c,u),window.open(l,c,u)}}},{key:"sendEmail",value:function sendEmail(t,r){var o=this.options,i=o.uriform["send-email"].replace("%subject%",encodeURIComponent(o.locale.subject)).replace("%text%",this.text(r));console.log(i,"_self"),window.open(i,"_self")}},{key:"copyLink",value:function copyLink(t,r){if(this.element){var o=this.options,i=document.createElement("textarea");if(i.style="position:absolute;width:0;height:0;opacity:0;z-index:-1;overflow:hidden",i.value=r.url.toString(),this.appendNode(this.element,i),i.focus(),i.select(),document.execCommand("copy"),i.remove(),o.fx){var a=this.root,l=this.compo(!1,"fx-copied-link--ground",{hidden:!0}),c=this.compo("span","copied-link-message",{innerText:o.locale.copied});a.classList.add("share-fx-copied-link"),l.install(a),c.install(a),l.show(),this.delay((function(){c.uninstall(a),l.uninstall(a),a.classList.remove("share-fx-copied-link")}),l,800)}}}},{key:"webShare",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(t,r){return regeneratorRuntime.wrap((function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.navigator.share({title:r.title,url:r.url});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),t.t0 instanceof TypeError?console.info("ensemble.SocialShare.webShare","TODO fallback"):console.log("ensemble.SocialShare.webShare",t.t0.message);case 8:case"end":return t.stop()}}),_callee4,null,[[0,5]])}))),function webShare(t,o){return r.apply(this,arguments)})}]),SocialShare}(d);t.SocialShare=y}));